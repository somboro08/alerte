{% extends "base.html" %}

{% block title %}Mon profil - SignalAlert{% endblock %}

{% block head_extra %}
<style>
.profile-container {
    max-width: 800px;
    margin: 0 auto;
    padding: var(--spacing-xl) 0;
}

.profile-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-xl);
}

.profile-avatar {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 3rem;
    color: var(--white);
}

.profile-info h1 {
    margin-bottom: var(--spacing-xs);
}

.profile-grid {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: var(--spacing-xl);
}

@media (max-width: 768px) {
    .profile-grid {
        grid-template-columns: 1fr;
    }
}

.profile-section {
    background: var(--white);
    padding: var(--spacing-lg);
    border-radius: var(--border-radius-lg);
    box-shadow: var(--shadow-sm);
}

.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--spacing-lg);
}

.stat-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--spacing-md) 0;
    border-bottom: 1px solid var(--gray-light);
}

.stat-item:last-child {
    border-bottom: none;
}
</style>
{% endblock %}

{% block content %}
<div class="container profile-container">
    <!-- Profile Header -->
    <div class="profile-header">
        <div class="profile-avatar">
            {{ current_user.username[0]|upper }}
        </div>
        <div class="profile-info">
            <h1>{{ current_user.username }}</h1>
            <p style="color: var(--gray-color);">
                <i class="fas fa-envelope"></i> {{ current_user.email }}
            </p>
            <p style="color: var(--gray-color);">
                <i class="fas fa-calendar-alt"></i> Membre depuis {{ current_user.created_at.strftime('%d/%m/%Y') }}
            </p>
        </div>
    </div>
    
    <!-- Profile Content -->
    <div class="profile-grid">
        <!-- Informations -->
        <div class="profile-section">
            <div class="section-header">
                <h2><i class="fas fa-user"></i> Informations personnelles</h2>
                <button class="btn btn-outline btn-sm" onclick="alert('Fonctionnalité à venir')">
                    <i class="fas fa-edit"></i> Modifier
                </button>
            </div>
            
            <div class="form-group">
                <label class="form-label">Nom d'utilisateur</label>
                <input type="text" class="form-control" value="{{ current_user.username }}" disabled>
            </div>
            
            <div class="form-group">
                <label class="form-label">Adresse email</label>
                <input type="email" class="form-control" value="{{ current_user.email }}" disabled>
            </div>
            
            <div class="form-group">
                <label class="form-label">Date d'inscription</label>
                <input type="text" class="form-control" 
                       value="{{ current_user.created_at.strftime('%d %B %Y') }}" disabled>
            </div>
        </div>
        
        <!-- Statistiques -->
        <div class="profile-section">
            <h2><i class="fas fa-chart-bar"></i> Mes statistiques</h2>
            
            {% set user_signalements = current_user.signalements %}
            {% set active_count = user_signalements|selectattr('status', 'equalto', 'active')|list|length %}
            {% set found_count = user_signalements|selectattr('status', 'equalto', 'found')|list|length %}
            {% set days_since = (now - current_user.created_at).days %}
            
            <div class="stat-item">
                <span>Signalements créés</span>
                <span style="font-weight: 600;">{{ user_signalements|length }}</span>
            </div>
            
            <div class="stat-item">
                <span>Signalements actifs</span>
                <span style="font-weight: 600; color: var(--secondary-color);">
                    {{ active_count }}
                </span>
            </div>
            
            <div class="stat-item">
                <span>Signalements résolus</span>
                <span style="font-weight: 600; color: var(--primary-color);">
                    {{ found_count }}
                </span>
            </div>
            
            <div class="stat-item">
                <span>Membre depuis</span>
                <span style="font-weight: 600;">
                    {{ days_since }} jour{% if days_since > 1 %}s{% endif %}
                </span>
            </div>
        </div>
    </div>
    
    <!-- Actions -->
    <div class="profile-section" style="margin-top: var(--spacing-xl);">
        <h2><i class="fas fa-cog"></i> Paramètres du compte</h2>
        
        <div style="display: flex; flex-direction: column; gap: var(--spacing-md);">
            <button class="btn btn-outline" style="text-align: left;" onclick="alert('Fonctionnalité à venir')">
                <i class="fas fa-key"></i> Changer le mot de passe
            </button>
            
            <button class="btn btn-outline" style="text-align: left;" onclick="alert('Fonctionnalité à venir')">
                <i class="fas fa-bell"></i> Préférences de notifications
            </button>
            
            
            <button class="btn btn-outline" style="text-align: left;" onclick="alert('Fonctionnalité à venir')">
                <i class="fas fa-eye"></i> Confidentialité
            </button>
            
            <button class="btn btn-danger" style="text-align: left; margin-top: var(--spacing-lg);" 
                    onclick="if(confirm('Êtes-vous sûr de vouloir supprimer votre compte ? Cette action est irréversible.')) alert('Fonctionnalité à venir')">
                <i class="fas fa-trash"></i> Supprimer mon compte
            </button>
        </div>
    </div>
</div>
{% endblock %}